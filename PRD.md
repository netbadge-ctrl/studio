# 数据中心智能运维助手 - 产品需求文档 (PRD)

| 版本 | 日期       | 作者   | 变更内容             |
| :--- | :--------- | :----- | :------------------- |
| V1.0 | 2024-05-24 | Gemini | 初始版本，基于现有功能创建 |
| V2.0 | 2024-05-25 | Gemini | 根据反馈重写，增加详细的交互逻辑和状态说明 |

---

## 1. 项目概述

### 1.1. 项目背景

随着数据中心规模的持续扩大和业务复杂性的增加，传统的工单处理和设备运维方式已难以满足高效、精准、安全的操作要求。一线运维工程师需要在复杂的机房环境中进行大量的物理操作，而主管则需要实时掌握团队的工作状态和负载情况。本项目旨在开发一款以移动端为核心的智能运维助手，通过现代化的 UI/UX 和智能化功能，赋能数据中心运维团队。

### 1.2. 产品目标

- **提升效率**：简化工程师从接收工单到完成操作的全流程，减少不必要的人工核对和信息查找时间。
- **降低风险**：通过清晰的指引、智能的配置比对和异常诊断，降低物理操作的出错率。
- **增强管理可视性**：为主管提供实时的团队任务视图和数据洞察，辅助其进行更合理的资源调配。
- **优化用户体验**：打造一款符合移动端操作习惯、界面清爽、交互流畅的现代化工具，提升员工的工作满意度。

### 1.3. 核心用户

- **数据中心运维工程师**：工单的执行者，负责具体的设备安装、配置、更换和故障处理。
- **数据中心运维主管**：团队的管理者，负责工单的分配、进度跟踪和团队资源协调。

---

## 2. 用户角色与核心场景

### 2.1. 运维工程师 (Alice)

- **角色描述**：一线操作人员，每天需要处理多个运维工单，熟悉机房环境，但需要清晰的指令来完成复杂的硬件配置任务。
- **核心场景**：
    - **上班后**：打开应用，在“我的任务”页面查看今天被分配到的所有工单。
    - **准备阶段**：点击一个“已分配”或“进行中”的工单，进入“工单详情页”。仔细核对需要操作的“设备清单”和需要领用的“所需备件清单”。
    - **开始操作**：确认备件无误后，点击底部的“开始操作”按钮，进入“工单操作页”。
    - **执行操作**：
        1. 在机柜前，通过“扫描设备”功能快速定位到要操作的设备。
        2. 找到设备后，其状态自动由“待处理”变为“改配中”。
        3. 根据操作指引图片和“配件操作”列表，完成硬件的插拔。
        4. 完成物理操作后，点击“硬件改配完成”按钮，设备状态变为“等待配置”。
        5. 完成带外配置后，点击“完成带外配置”，设备状态变为“待检测”。
        6. 点击“发起结单检测”。
    - **处理结果**：
        - **检测通过**：设备状态自动变为“改配完成”。
        - **检测异常**：设备状态变为“检测异常”。点击“查看异常报告”，根据报告中的硬件或网络错误信息排查问题。修复后，重新发起结单检测。
    - **完成工单**：当工单内所有设备状态都变为“改配完成”后，点击“完成工单”按钮，结束任务。

### 2.2. 运维主管 (Bob)

- **角色描述**：团队领导，关心整体工作进度、团队成员的负载均衡以及潜在的风险点。
- **核心场景**：
    - **日常管理**：打开“主管仪表盘”，查看所有工单的状态（待处理、已分配、进行中、已完成等）。
    - **任务分配**：发现“待处理”工单，点击“分配”按钮。在弹出的移动端友好的分配界面中，查看每个工程师的当前负载（进行中任务数、今日已完成数），选择最合适的工程师进行分配。
    - **进度跟踪**：通过仪表盘随时了解关键工单的进展状态。

---

## 3. 功能详述 (Features)

### 3.1. 工程师视图 - 我的工单

- **功能 ID**: FEAT-ENG-01
- **描述**: 应用的默认首页，以移动端友好的卡片列表形式展示当前登录工程师被分配的所有工单。
- **UI/UX 规范**:
    - 每个工单是一个独立的、可点击的卡片。
    - 卡片上应清晰展示工单的核心信息：标题、ID、状态、设备数量、机房模块等。
    - 不同状态的工单（如“进行中”、“已分配”）应有不同的颜色或图标标识，便于快速区分。
- **交互逻辑**:
    - 点击状态为“已分配”、“进行中”、“已阻塞”的工单，导航至“工单详情页”（准备阶段）。
    - 点击状态为“已完成”的工单，直接导航至“工单操作页”，以只读模式查看最终操作结果。

### 3.2. 主管视图 - 主管分配工单

- **功能 ID**: FEAT-LEAD-01
- **描述**: 主管的核心管理界面，以列表形式展示所有工单，并提供分配功能。
- **UI/UX 规范**:
    - 列表应清晰展示工单标题、状态和当前被分配人。
    - 每行提供一个“分配”按钮，点击后弹出“分配工单”对话框。
    - **分配对话框 (移动端优化)**:
        - 放弃传统的表格布局，采用**列表卡片**设计。
        - 每个工程师是一个卡片，清晰展示姓名、当前进行中工单数、今日完成数。
        - 通过点击卡片或卡片上的复选框来选择/取消选择工程师，点击区域要足够大，易于操作。
        - 底部提供“保存分配”和“取消”按钮。

### 3.3. 工单详情页 (准备阶段)

- **功能 ID**: FEAT-DETAIL-01
- **描述**: 用户从工单列表点击后进入的页面，用于操作前的准备和信息核对。这是执行物理操作前的最后一步。
- **UI/UX 规范**:
    - 页面主要由“设备清单”和“所需备件”两个信息卡片组成。
    - **设备清单**: 以列表形式展示所有需要操作的设备序列号及其物理位置。
    - **所需备件**:
        - 卡片高度应根据内容**动态自适应**。
        - **对有特殊性能要求的备件（如高性能网卡）**：
            - 在型号后增加一个醒目的图标（如 ⚡️）和“有性能要求”的文本提示。
            - 该行应设计为**可展开的 Accordion** 样式。点击后，展开区域清晰地展示“性能要求”和“推荐备件SN清单”。
    - **底部操作栏**:
        - 提供一个常驻底部的“开始操作”按钮。
- **交互逻辑**:
    - 无论工单状态是“已分配”还是“进行中”，此页面都应可访问，并提供“开始操作”按钮。
    - 如果工单状态为“已完成”，此页面为只读状态，底部操作按钮置灰或隐藏。

### 3.4. 工单操作页 (执行阶段)

- **功能 ID**: FEAT-OPERATE-01
- **描述**: 工程师进行实际物理操作的核心界面，其内容和操作根据设备状态动态变化。
- **UI/UX 规范**:
    - 顶部提供一个醒目的设备扫描/查找入口，方便工程师快速定位到目标设备。
    - 每个设备是一个可展开的 Accordion 项，外部展示其序列号、位置和**当前状态徽章**。
    - **底部操作栏**: 提供“扫描设备”、“更多操作”（批量检测、增领/回库备件）和“完成工单”等核心操作。

- **设备状态驱动的UI/UX**:
    - **状态: `待处理` / `改配中`**
        - **内容**: 展开后，显示完整的操作指引（图片/视频）和“配件操作”列表。
        - **支持操作**: 底部操作栏显示“硬件改配完成，开始带外配置”按钮。
    - **状态: `等待配置`**
        - **内容**: 隐藏物理操作指引，可显示带外配置相关的命令或提示。
        - **支持操作**: 底部操作栏显示“完成带外配置”按钮。
    - **状态: `待检测`**
        - **内容**: 界面变为等待状态，提示用户可以发起检测。
        - **支持操作**: 底部操作栏显示“发起结单检测”按钮，并提供“标记异常”选项。
    - **状态: `检测异常`**
        - **内容**: 界面显示醒目的异常状态提示。
        - **支持操作**: 底部操作栏的核心按钮变为红色的“查看异常报告”。
    - **状态: `改配完成`**
        - **内容**: 界面显示绿色的成功状态，所有操作指引和按钮均被隐藏或置灰。Accordion 变为只读状态，仅供查阅。
        - **支持操作**: 无。

### 3.5. 备件管理

- **功能 ID**: FEAT-PARTS-01
- **描述**: 处理领用和回库备件的流程。
- **UI/UX 规范**:
    - **增领备件**:
        - 提供清晰的列表，展示此工单需要领用的备件型号。
        - 用户可点击“扫码坏件”来记录更换下来的坏件序列号，为申领新备件提供依据。
    - **备件回库 (移动端优化)**:
        - 弹窗标题统一为“备件回库”。
        - 弹窗内放弃表格，采用**列表卡片**设计，每个待回库的备件作为一个卡片。
        - 卡片内垂直堆叠展示备件型号、序列号和应放回的“回库盒号”，信息一目了然。

### 3.6. 异常检测报告

- **功能 ID**: FEAT-ANOMALY-01
- **描述**: 当设备“结单检测”失败时，向工程师展示一份清晰、可操作的诊断报告。
- **UI/UX 规范**:
    - 弹窗应采用移动端友好的设计，信息**垂直布局**，避免使用 Tabs 或多栏对比。
    - **仅展示错误信息**，过滤掉所有正常的检测项。
    - **硬件错误**:
        - 清晰地列出所有线上实际配置与目标配置不一致的硬件。
        - 对每一个不一致的插槽，都明确展示“线上”和“目标”的备件信息，并用醒目的视觉元素（颜色、图标）高亮差异。
    - **网络错误**:
        - 清晰地列出所有检测失败的网络项及其失败原因。
    - 如果所有检测项都通过，则应明确提示“所有测试均已通过”。

### 3.7. 服务器搬迁流程

- **功能 ID**: FEAT-MOVE-01
- **描述**: 为“服务器搬迁”类型的工单设计的特殊流程。
- **UI/UX 规范**:
    - **搬出操作**:
        - 提供一个专门的“搬出操作”表单，用于记录物流信息。
        - **日期选择器 (移动端优化)**: 点击日期输入框后，应**以居中的模态对话框（Dialog）形式**弹出日历，而不是在按钮旁弹出浮窗。这提供了更稳定、更可靠的移动端选择体验。

---

## 4. 非功能性需求

- **设计语言**: 整体采用现代、简洁的设计风格。以卡片、列表和清晰的弹窗为主要交互模式，符合主流移动应用的设计范式。
- **响应式设计**: 优先为移动端进行设计（Mobile-First），同时兼容桌面端访问。
- **性能**: 界面加载和交互响应需保持流畅，避免卡顿。
- **可访问性 (A11y)**: 所有交互组件（如弹窗）需符合无障碍设计标准，例如，为对话框提供必要的标题（即使在视觉上隐藏）。

---

## 5. 技术栈概述

- **前端框架**: Next.js (App Router)
- **语言**: TypeScript
- **UI 库**: React, ShadCN UI, Tailwind CSS
- **图表**: Recharts
- **图标**: Lucide React
- **AI 功能** (规划中): Genkit (Google AI)